<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<meta charset="UTF-8" />
	<title>The Hedgehog's Delima | Indie Rock</title>
	<link rel="stylesheet" href="http://yui.yahooapis.com/2.9.0/build/reset/reset-min.css"/>
	<link rel="stylesheet" href="css/style.css"/>
	<link rel="stylesheet" href="css/dot-luv/jquery-ui-1.8.18.custom.css"/>
	<link rel="stylesheet" href="css/cplay/cplayer.css">
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
	<script>
	function audioControl(playerId, settings){
		var self = this;
		var audioTagSupport = !!(document.createElement('audio').canPlayType);
		var currentTrack, displayControls, playerSettings = {};
		playerSettings.autoPlay = false;
		this.cplayer = {};
		this.playIt = function(){
			self.cplayer.play()
		};
		displayControls = true;
		this.findAudioElement = function(obj){
			if(typeof obj == 'object' && playerId.nodeName === 'AUDIO'){
				this.cplayer=obj;
				console.log('audio element');
				return !!this.cplayer;
			}else if(typeof obj == 'object' && playerId.nodeName != 'AUDIO'){
				if(audioTagSupport){
					this.cplayer = createHTML5Audio(obj);
					console.log('not audio element');
				}
				//createAudioElement(parent);
			}else if(typeof obj == 'string'){
				console.log('string')
				this.findAudioElement(document.getElementById(playerId));
			};
		}
		createHTML5Audio = function(parent){
			var controlRack, playButton, pauseButton, skipForward, skipBack, volumeSlide, trackDetails, trackList, playerControls=[];
			var cplayer=document.createElement('audio');
			cplayer.setAttribute('controls', 'true');
			cplayerSrc=document.createElement('source');
			cplayerSrc.setAttribute('src', '/mp3/CakeMahnaMahna.m4a');
			cplayer.appendChild(cplayerSrc);
			parent.appendChild(cplayer);
			if(displayControls){
				//create HTML elements for audio control
				controlRack=document.createElement('ul');
				controlRack.setAttribute('id', 'cPlayControlRack')
				playerControls[0] = document.createElement('li'); //play button
				playerControls[0].className += 'cplaybutton';
				playerControls[0].addEventListener('click', function(){self.playIt();}, true);
				playerControls[1] = document.createElement('li'); //pause button
				playerControls[1].className += 'CpauseButton CplayHidden';
				playerControls[1].addEventListener('click', function(){self.pauseIt();}, true);
				if(playerSettings.autoPlay){
					playerControls[0].className += ' CplayHidden'; //hide play button
					playerControls[1].className.replace( /(?:^|\s)CplayHidden(?!\S)/ , '' ); //unhide pause button
				}
				playerControls[2] = document.createElement('li'); //skip track back
				playerControls[2].className +=  'CplaySkipBack';
				playerControls[2].addEventListener('click', function(){self.skipBCK();}, true);
				playerControls[3] = document.createElement('li'); //skip track forward
				playerControls[3].className += 'CplaySkipForward';
				playerControls[3].addEventListener('click', function(){self.skipFWD();}, true);
				playerControls[4] = document.createElement('li'); //volume icon
				playerControls[4].className += 'CplayVolumeIcon';
				playerControls[4].addEventListener('click', function(){self.toggleMute();}, true);
				playerControls[5] = document.createElement('li'); //volume slider
				playerControls[5].className += 'CplayVolumeSlide';
				for(i=0; i<playerControls.length; i++){
					controlRack.appendChild(playerControls[i]);
				}
				parent.insertBefore(controlRack, cplayer.nextSibling);
			}
			return cplayer;
		}
		this.findAudioElement(playerId);
		console.log(this.cplayer)
	}
	audioControl.prototype.play = function(/*playerObj,*/ callback){
			this.playIt();
			if(typeof callback =='function'){
				callback();
			};
	}
	audioControl.prototype.pause = function(playerObj, callback){
			document.getElementById(playerObj).pause();
			if(typeof callback =='function'){
				callback();
			};
	}
	audioControl.prototype.volumeUp = function(playerObj, volumeLevel, callback){
			document.getElementById(playerObj).volume+=0.1;
			if(typeof callback =='function'){
				callback();
			}else{
				return document.getElementById(playerObj).volume;
			}
	
	}
	audioControl.prototype.volumeDown = function(playerObj, callback){
			document.getElementById(playerObj).volume-=0.1;
			if(typeof callback =='function'){
				callback();
			}else{
				return document.getElementById(playerObj).volume;
			}
	
	}
	audioControl.prototype.setVolume = function(playerObj, volumeLevel, callback){
			document.getElementById(playerObj).volume=volumeLevel;
			if(typeof callback =='function'){
				callback();
			}else{
				return document.getElementById(playerObj).volume;
			}
	}
	
	//audioControl.prototype.
	$(document).ready(function(){
	audioElement = document.getElementById('player');
	audioElement2 = document.getElementById('player2');
	audioElement3 = 'player3';
	player = new audioControl(audioElement);
	player2= new audioControl(audioElement2);
	player3= new audioControl(audioElement3);
		$('#playButton').bind('click',function(){
			player.play('player');
			$(this).hide();
			$('#pauseButton').show();
			return false;
		})
		$('#play2').bind('click', function(){
			player2.play();
		})
	})
	</script>
</head>
<body>
	<audio id="player" controls>
		<source src="/mp3/CakeMahnaMahna.m4a" />
	Hello
	</audio>
	<a href="#" id="playButton">play!</a>
	<a href="#" id="pauseButton" style="display:none;">pause</a>
	<div id="player2">
	</div>
	<div id="player3"></div>
	<div id="play2">play 2!</div>
</body>
</html>